# 产品需求文档：网站用户登录模块文档

| 版本 | 修改日期 | 修改人 | 修改内容 |
| :--- | :--- | :--- | :--- |
| V1.0 | 2024-05-20 | [您的名字] | 初始版本创建 |

## 1. 项目背景与目标

**背景**：构建用户身份识别体系，确保账户安全，并为用户提供个性化服务。  
**目标**：提供安全、便捷、多样的登录方式，降低用户登录门槛，同时保障系统数据的安全性。

## 2. 功能范围 (Scope)

本期需求包含以下主要功能模块：

* 账号密码登录（邮箱/手机号）
* 手机验证码登录（免密登录）
* 第三方快捷登录（微信/Google/Apple，视情况而定）
* 忘记密码/找回密码
* 异常处理与风控（防暴力破解、图形验证码）
* 登出与会话管理

## 3. 详细功能需求

### 3.1 账号密码登录

**输入项**：
* 账号：支持邮箱或手机号（自动识别格式）。
* 密码：输入框默认掩码显示（******），右侧提供“显示/隐藏”切换图标。

**逻辑规则**：
* **校验机制**：前端校验非空；后端校验账号密码匹配性。
* **错误反馈**：为了防止账号遍历攻击，当账号或密码错误时，统一提示文案：“账号或密码错误”（不要提示“账号不存在”）。连续输错 5 次密码，暂时锁定账号 15 分钟或强制弹出图形验证码。
* **记住我 (Remember Me)**：勾选后，保存 Token 有效期为 7 天（或 30 天）；未勾选，关闭浏览器即清除会话。

### 3.2 手机验证码登录 (无密码模式)

**输入项**：手机号、短信验证码。

**获取验证码逻辑**：
* 点击“获取验证码”按钮，开始 60秒 倒计时。
* **前置校验**：手机号格式是否正确。
* **防刷机制**：同一手机号 24 小时内限制发送 X 条；同一 IP 限制发送 Y 条。

**登录逻辑**：
* 若手机号已注册：直接登录。
* 若手机号未注册：系统自动创建账号并登录（需在 UI 上提示“未注册手机号验证后将自动创建账号”）。

### 3.3 第三方登录 (OAuth 2.0)

**支持平台**：微信 (扫码)、Google、Apple ID。

**逻辑**：
* 用户授权后，获取 OpenID/UnionID。
* **已绑定**：直接登录成功。
* **未绑定**：跳转至“绑定手机号/账号”页面（依据当地法律法规，通常要求实名制需绑定手机）。或直接生成新账号（仅限非实名强需求场景）。

### 3.4 忘记密码 (找回流程)

* **身份验证**：输入注册邮箱或手机号。
* **安全校验**：发送验证链接（邮件）或 6位数字验证码（短信）。
* **重置密码**：输入新密码（需符合密码强度要求）并二次确认。
* **完成**：提示修改成功，并跳转回登录页。

## 4. 安全与风控需求 (Security Requirements)

这是登录文档中最关键的部分，直接关系到系统安全。

### 4.1 密码安全

* **传输加密**：全程使用 HTTPS 协议，密码在前端进行哈希 (Hash) 处理后再传输，或使用 SSL 传输明文并在后端加盐 (Salt) 哈希存储。
* **强度校验**：新用户注册或重置密码时，强制要求：8-20位，包含字母+数字（可选：+特殊符号）。

### 4.2 防暴力破解 (Brute-force Protection)

* **图形验证码 (CAPTCHA)**：触发条件：同一 IP 或同一账号连续登录失败 3 次后，在点击“登录”前强制弹出图形验证码/滑块验证。
* **账号锁定**：连续失败 X 次，锁定账号 N 分钟。

### 4.3 会话管理 (Session Management)

* **单点登录 (SSO)**：(可选) 同一账号是否允许同时在多地登录？（通常 ToB 系统限制单点，ToC 允许由用户踢出旧设备）。
* **自动登出**：用户无操作超过 30 分钟（银行类）或 24 小时（普通类），Token 失效，需重新登录。

## 5. UI/UX 交互要求

**布局**：采用左右分栏（左侧品牌图，右侧登录框）或 居中卡片式设计。

**交互细节**：
* **聚焦**：进入页面时，光标默认聚焦在“账号”输入框。
* **回车键**：输入密码后，按 Enter 键直接触发登录操作。
* **Loading态**：点击登录后，按钮变为“登录中...”并不可点击，防止重复提交。
* **实时反馈**：手机号格式错误时，输入框失焦 (Blur) 即显示红色错误提示，不要等到点击登录才报错。

## 6. 数据埋点需求 (Analytics)

需要统计以下事件，以便后续优化转化率：
* **页面曝光 PV/UV**：有多少人到了登录页。
* **登录成功率**：成功次数 / 尝试点击次数。
* **失败原因分布**：密码错误、验证码错误、系统错误的占比。
* **登录方式偏好**：验证码登录 vs 密码登录 vs 第三方登录 的使用比例。

## 7. 非功能性需求

* **性能**：登录接口响应时间 < 500ms（高并发下 < 1s）。
* **兼容性**：支持 Chrome, Safari, Firefox, Edge 主流浏览器；适配移动端 H5 页面。
* **可用性**：第三方登录服务挂掉时，不应影响主流程（账号密码登录）。