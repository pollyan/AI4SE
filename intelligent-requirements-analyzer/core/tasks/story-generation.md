<!-- Powered by BMAD™ Core -->

# 用户故事生成任务

## 任务目的

基于Epic定义和PRD需求，生成符合INVEST原则的高质量用户故事，确保每个故事都是独立的、可协商的、有价值的、可估算的、小规模的和可测试的。

## 前置条件

- Epic分解已完成，存在详细的Epic文档
- PRD文档中的用户画像和场景已明确
- Epic的验收标准和功能范围已定义

## 故事生成原则

### INVEST原则详解

**Independent (独立性)**
- 每个故事应该尽可能独立于其他故事
- 避免故事间的强依赖关系
- 可以独立开发、测试和部署

**Negotiable (可协商性)**
- 故事不是合同，而是对话的起点
- 实现细节可以在开发过程中协商
- 保留适度的灵活性

**Valuable (有价值)**
- 每个故事必须为最终用户提供可感知的价值
- 避免纯技术性的故事
- 明确价值实现方式

**Estimable (可估算)**
- 开发团队能够估算故事的工作量
- 故事足够明确，风险可识别
- 复杂度在可控范围内

**Small (小规模)**
- 故事规模适中，通常1-3天完成
- 可以在一个迭代周期内完成
- 避免过大的故事

**Testable (可测试)**
- 有明确的验收标准
- 可以编写测试用例
- 成功标准可验证

## 故事生成流程

### 第1步：Epic故事分解

**对每个Epic执行以下分解：**

1. **用户场景识别**
   - 分析Epic中的用户工作流
   - 识别关键的用户交互点
   - 确定主要和次要使用场景

2. **功能原子化**
   - 将Epic中的复合功能拆分为原子功能
   - 确保每个原子功能都有独立价值
   - 考虑功能的最小可用单位

3. **用户角色映射**
   - 确定每个功能对应的用户角色
   - 分析不同角色的使用情境
   - 考虑角色权限和访问控制

### 第2步：故事模板应用

**使用标准用户故事格式：**

```
作为 [用户角色]
我希望 [功能描述]
以便 [价值实现]
```

**增强故事要素：**

1. **上下文描述**
   - 用户使用的具体情境
   - 触发条件和前置状态
   - 相关的业务流程

2. **功能细节**
   - 具体的操作步骤
   - 系统响应和反馈
   - 异常情况处理

3. **价值阐述**
   - 用户获得的直接价值
   - 业务目标的支撑
   - 问题解决的程度

### 第3步：验收标准定义

**为每个故事定义清晰的验收标准：**

1. **Given-When-Then格式**
   ```
   Given [前置条件]
   When [用户操作]
   Then [预期结果]
   ```

2. **边界条件考虑**
   - 正常流程的验证
   - 异常情况的处理
   - 边界值的测试

3. **非功能性要求**
   - 性能要求（响应时间等）
   - 安全要求（权限验证等）
   - 可用性要求（界面友好性等）

### 第4步：故事优先级和估算

**优先级评估：**

1. **用户价值维度**
   - 解决痛点的紧急程度
   - 使用频率和影响范围
   - 用户满意度提升程度

2. **业务价值维度**
   - 对业务目标的贡献度
   - 市场竞争优势
   - 收入或成本影响

3. **技术风险维度**
   - 实现复杂度
   - 技术依赖风险
   - 不确定性程度

**故事点估算指导：**
- 1点：简单CRUD操作，半天完成
- 2点：中等复杂度功能，1天完成
- 3点：复杂功能或有依赖，2-3天完成
- 5点：非常复杂，需要进一步分解
- 超过5点：必须拆分为更小的故事

### 第5步：故事质量验证

**使用story-quality-checklist检查：**

- [ ] 故事遵循标准"作为...我希望...以便..."格式
- [ ] 用户角色明确且符合用户画像
- [ ] 功能描述具体可理解
- [ ] 价值实现清晰可感知
- [ ] 验收标准完整可测试
- [ ] 故事规模适中（1-5点）
- [ ] 与其他故事依赖最小
- [ ] 技术可行性已确认

## 故事文档结构

**使用story-tmpl.yaml模板生成故事文档，包含：**

1. **故事基本信息**
   - 故事标题和编号
   - 所属Epic和优先级
   - 故事点估算

2. **故事描述**
   - 标准格式的故事陈述
   - 详细的上下文和场景
   - 相关的用户旅程步骤

3. **验收标准**
   - Given-When-Then场景列表
   - 边界条件和异常处理
   - 非功能性要求

4. **附加信息**
   - 设计原型或线框图链接
   - 相关文档引用
   - 技术实现备注

## 输出交付物

1. **故事清单**
   - 所有故事的概览表格
   - 按Epic分组的故事列表
   - 优先级和估算汇总

2. **详细故事文档**
   - 每个故事的完整规格
   - 存储在docs/stories/目录下
   - 文件命名：story-{epic编号}-{故事编号}-{简短标题}.md

3. **迭代计划建议**
   - 基于故事点的迭代规划
   - 依赖关系和交付顺序
   - 风险故事的特别标注

## 后续开发准备

故事生成完成后，为开发团队提供：

- **Ready for Development**的故事池
- 清晰的验收标准和测试用例框架
- 优先级排序的开发计划
- 与产品负责人协商的基础文档

确保开发团队能够：
- 理解每个故事的业务价值
- 准确估算开发工作量
- 独立实施每个故事
- 验证实现的正确性
